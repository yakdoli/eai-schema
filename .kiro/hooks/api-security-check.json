{
  "name": "API 보안 검사",
  "description": "API 라우터 파일의 보안과 설계 원칙을 검사합니다",
  "trigger": {
    "event": "file_save",
    "patterns": [
      "src/routes/*.ts",
      "src/routes/**/*.ts"
    ]
  },
  "prompt": "API 라우터 파일의 보안과 설계를 검토해주세요:\n\n🔒 필수 보안 요소:\n- 입력 검증 미들웨어 (Joi, express-validator 등)\n- 레이트 리미팅 적용 여부\n- CORS 설정 확인\n- 인증/권한 검사 로직\n- 파일 업로드 시 MIME 타입 검증\n- SSRF 방지 (URL 입력 시)\n- XXE 공격 방지 (XML 처리 시)\n\n📝 API 설계 원칙:\n- RESTful 원칙 준수\n- 일관된 응답 형식 (SuccessResponse/ErrorResponse)\n- 적절한 HTTP 메서드 사용\n- 적절한 HTTP 상태 코드\n- 에러 정보 노출 방지\n\n🛡️ 에러 처리:\n- try-catch 블록 사용\n- 적절한 로깅 (Winston)\n- 사용자 친화적 에러 메시지\n\n누락된 보안 요소나 설계 문제가 있다면 코드 예시와 함께 구체적으로 제안해주세요. 보안 취약점이 발견되면 즉시 경고해주세요.",
  "enabled": true,
  "priority": "critical",
  "tags": ["api", "security", "routes"]
}